//tealium universal tag - utag.596 ut4.0.202102241417, Copyright 2021 Tealium.com Inc. All Rights Reserved.
utag.init_mobile=(function(){var _version="2.0.0";var _checkVersion=function(v1,v2){var old_mobile_version=v1.split(".");var new_mobile_version=v2.split(".");var oa=parseInt(old_mobile_version[0]);var na=parseInt(new_mobile_version[0]);var ob=parseInt(old_mobile_version[1]);var nb=parseInt(new_mobile_version[1]);var oc=parseInt(old_mobile_version[2]);var nc=parseInt(new_mobile_version[2]);return(na>oa||(na==oa&&nb>ob)||(na==oa&&nb==ob&&nc>oc));};return{init:function(){if(utag.mobile&&utag.mobile.version){if(!_checkVersion(utag.mobile.version,_version)){return;}}if(utag.mobile&&utag.mobile.queue&&utag.mobile.queue.isActive()){return;}
utag.mobile={version:_version,removeiFrame:function(id){var iframe=document.getElementById(id);if(iframe){iframe.parentElement.removeChild(iframe);}},remote_api:(function(){return{response:{},api_builder:function(){var _data,_command_id,_name,_callback_function,_cmd_name;var _add_object=function(type,key_or_object,value){var _payload=_cmd_name.payload;if(typeof key_or_object=="object"){if(!_payload[type]){_payload[type]=key_or_object;}else{for(var key in key_or_object){_payload[type][key]=key_or_object[key];}}}else{if(!_payload[type]){_payload[type]={}}_payload[type][key_or_object]=value;}};var _createIFrame=function(url,id){var d=document.createElement("iframe");d.setAttribute("id","tealium");d.setAttribute("height","1");d.setAttribute("width","1");d.setAttribute("style","display:none");d.setAttribute("src",url);d.setAttribute("id",id);document.body.appendChild(d);};return{init:function(command_id,name,u){var cmd;_data=u;_command_id=command_id;_name=name;if(!_data[command_id]){_data[command_id]={};}cmd=_data[command_id];cmd.base_url="tealium://"+command_id+"?request=";cmd[_name]={"config":{},"payload":{}};_cmd_name=_data[_command_id][_name];if(_command_id=="_http"){this.url=function(url){_cmd_name["payload"]["url"]=url;return this;};this.method=function(method){this.method=method;return this;};this.authenticate=function(username,password){_cmd_name["payload"]["authenticate"]={"username":username,"password":password};return this;};this.add_header=function(key_or_object,value){_add_object("headers",key_or_object,value);return this;};this.add_parameter=function(key_or_object,value){_add_object("parameters",key_or_object,value);return this;};}
if(_command_id=="_push"){this.project_number=function(project_number){_cmd_name["payload"]["project_number"]=project_number;return this;}}
if(_command_id=="_http"||_command_id=="_push"){this.add_body=function(string_key_or_object,value){var _payload=_cmd_name.payload;if(typeof string_key_or_object=="string"&&!value){_payload.body=string_key_or_object;}else if(typeof string_key_or_object=="object"){add_object("body",string_key_or_object);}else{if(!_payload.body)_payload.body={};_payload.body[string_key_or_object]=value;}return this;};}
this.callback=function(callback){_callback_function=callback;this.response_id();return this;};this.response_id=function(response_id){_cmd_name["config"]["response_id"]=(response_id)?_name+"_"+response_id:_name;_cmd_name["response_id_set"]=function(){_cmd_name["config"]["response_id"]=_name+"_"+new Date().getTime()+Math.floor((Math.random()*2000)+1);};return this;};this.trigger=function(){var _payload=_cmd_name.payload;if(!_callback_function){this.callback(this.payload.callback_function);}if(_cmd_name.response_id_set){_cmd_name.response_id_set();}if(_payload.body&&typeof _payload.body=="object"&&_payload.headers&&_payload.headers["Content-Type"]&&_payload.headers["Content-Type"]!="application/x-www-form-urlencoded"){_payload.body=JSON.stringify(_payload.body);}if(!utag.mobile.remote_api.response[_command_id]){utag.mobile.remote_api.response[_command_id]={}}if(this.payload&&this.custom=="module"){_payload=this.payload;}if(this.payload&&this.custom=="command"){for(var argument in this.payload){_payload[argument]=this.payload[argument];}}var response_id=_cmd_name["config"].response_id;console.info("creating callback",response_id);(function(response_id,_command_id,_name){utag.mobile.remote_api.response[_command_id][response_id]=function(code,body){console.info("callback",_command_id,_name,response_id);utag.mobile.removeiFrame(response_id);if(_callback_function){_callback_function(code,body);}};}(response_id,_command_id,_name));console.info("open",_data.id,_command_id,_name);console.info("url",_data[_command_id].base_url+encodeURIComponent(JSON.stringify(_cmd_name)));_createIFrame(_data[_command_id].base_url+encodeURIComponent(JSON.stringify(_cmd_name)),response_id);(function(response_id){setTimeout(function(){utag.mobile.removeiFrame(response_id);},30000);}(response_id));};return this;},add_argument:function(argument,value){if(!value){value=""}if(this.custom&&this.custom=="module"){if(!this.payload){this.payload={"arguments":{}};}this.payload["arguments"][argument]=value;}else if(this.custom&&this.custom=="command"){if(!this.payload){this.payload={};}this.payload[argument]=value;}else{this[argument]=value;}return this;},is_custom_module:function(){this.custom="module";this.method=function(method_name){if(method_name){this.method=method_name;}else{this.method=function(method_name){this.method=method_name;}}return this;};if(this.payload){delete this.payload;}return this;},is_custom_command:function(){this.custom="command";if(this.payload){delete this.payload;}return this;}}}};}())};}}}());utag.init_mobile.init();try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;u.ev={"view":1,"link":1};u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"mapped_data":{"command_id":"","debug":""}};for(d in u.map){if(u.map.hasOwnProperty(d)&&b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data.mapped_data[e[f]]=b[d];}}}
var mapped_data=u.data.mapped_data;var command_id=(function(){if(mapped_data.command_id){return mapped_data.command_id;}else if(b.command_id){return b.command_id;}else{return"";}})();var debug=(function(){return(mapped_data.debug&&(mapped_data.debug==="true"||mapped_data.debug===true))||(b.debug&&b.debug==="true");})();var custom_command=utag.mobile.remote_api.api_builder();custom_command.init(command_id,"custom_command",u)
.is_custom_command();if(Object.keys(mapped_data).length>2){for(var key in mapped_data){custom_command.add_argument(key,mapped_data[key]);}}else{for(var key in b){custom_command.add_argument(key,b[key]);}}
if(command_id!==""){custom_command.trigger();}else{if(debug){try{console.log("596: TagBridge: No command_id set");}catch(e){}}}}};utag.o[loader].loader.LOAD(id);}("596","fxclub.main"));}catch(error){utag.DB(error);}
